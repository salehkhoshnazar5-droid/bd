{% extends "base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
  <h4 class="mb-0">ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…</h4>
  <a href="/admin/logout" class="btn btn-outline-danger btn-sm">Ø®Ø±ÙˆØ¬ Ø§Ø² Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</a>
</div>

  <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø± -->
  <div class="row mb-4">
  <div class="col-md-4">
      <div class="card text-center shadow-sm border-primary">
                <div class="card-body">
          <h6 class="card-title text-muted">Ú©Ù„ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h6>
          <h2 class="text-primary">{{ users|length }}</h2>
          <small class="text-muted">ÛµÛ° Ú©Ø§Ø±Ø¨Ø± Ø¢Ø®Ø± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…ÛŒ</small>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center shadow-sm border-success">
        <div class="card-body">
          <h6 class="card-title text-muted">Ú©Ù„ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§</h6>
          <h2 class="text-success">{{ stats.total_logs }}</h2>
          <small class="text-muted">ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡</small>
        </div>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="card text-center shadow-sm border-info">
        <div class="card-body">
          <h6 class="card-title text-muted">Ø§Ù†ÙˆØ§Ø¹ Ø¹Ù…Ù„ÛŒØ§Øª</h6>
          <h2 class="text-info">{{ stats.actions|length }}</h2>
          <small class="text-muted">Ø§Ù†ÙˆØ§Ø¹ Ø¹Ù…Ù„ÛŒØ§Øª Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡</small>
        </div>
      </div>
    </div>
  </div>

  <div class="card-header bg-light fw-bold">ğŸ‘¥ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</div>
    <div class="card-body p-0">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover table-sm mb-0">
          <thead class="table-secondary">
          <thead>
            <tr>
              <th>#</th>
              <th>Ø´Ù…Ø§Ø±Ù‡ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒÛŒ</th>
              <th>Ú©Ø¯ Ù…Ù„ÛŒ</th>
              <th>Ù†Ù‚Ø´</th>
              <th>ÙˆØ¶Ø¹ÛŒØª</th>
              <th>ØªØ§Ø±ÛŒØ® Ø¹Ø¶ÙˆÛŒØª</th>
            </tr>
          </thead>
          <tbody>
            {% for user in users %}
              <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.student_number }}</td>
                <td>{{ user.profile.national_code if user.profile else '-' }}</td>
                <td><span class="badge bg-dark">{{ user.role.name if user.role else '-' }}</span></td>
                <td>
                  {% if user.is_active %}
                    <span class="badge bg-success">ÙØ¹Ø§Ù„</span>
                  {% else %}
                    <span class="badge bg-danger">ØºÛŒØ±ÙØ¹Ø§Ù„</span>
                  {% endif %}
                </td>
                <td>{{ user.created_at.strftime('%Y-%m-%d') if user.created_at else '-' }}</td>
              </tr>
            {% else %}
              <tr><td class="text-center text-muted" colspan="6">Ù‡ÛŒÚ† Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Ø¢Ø®Ø±ÛŒÙ† Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ -->
  <div class="card shadow-sm">
    <div class="card-header bg-warning text-dark">â° Ø¢Ø®Ø±ÛŒÙ† Ù„Ø§Ú¯â€ŒÙ‡Ø§</div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-sm" id="recent-logs-table">
          <thead>
            <tr>
              <th>Ø²Ù…Ø§Ù†</th>
              <th>Ú©Ø§Ø±Ø¨Ø±</th>
              <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
              <th>ØªÙˆØ¶ÛŒØ­Ø§Øª</th>
            </tr>
          </thead>
          <tbody>
            {% for log in recent_logs %}
            <tr>
            <td><small class="text-muted">{{ log.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</small></td>
              <td>{{ log.student_number or '-' }}</td>
              <td><span class="badge bg-primary">{{ log.action }}</span></td>
              <td>{{ log.description or '-' }}</td>
            </tr>
            {% else %}
            <tr><td class="text-center text-muted" colspan="4">Ù„Ø§Ú¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

</div>
{% endblock %}
